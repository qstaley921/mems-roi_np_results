<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>New Patient Results Module</title>
  <meta name="description" content="New Patient Results Module" />
  <meta name="author" content="The Practice - Development Team" />

  <!-- Google Fonts -->
  <link
    rel="stylesheet"
    href="//fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic"
  />

  <!-- Minified CSS Bundle -->
  <link
    rel="stylesheet"
    href="https://members.mypgi.com/min/g=si-ms-css?v=0.62"
  />

  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://kit.fontawesome.com/425aa9ca2c.css"
    crossorigin="anonymous"
  />

  <!-- Custom Styles -->
  <link rel="stylesheet" href="styles/styles.css" />
</head>

<body>
  <!-- Header -->
  <div class="npi-roi-mod-header">
    <picture>
      <source media="(max-width: 768px)" srcset="imgs/header-mobile.png">
      <img src="imgs/header.png" alt="Header" class="npi-roi-mod-header-image">
    </picture>
  </div>

  <!-- Main Content -->
  <main class="npi-roi-mod-main-content">
    <div class="container-fluid">
      <div class="row">
        <!-- Left Column: New Patient Results -->
        <div class="col-lg-6 col-md-12">
          <!-- Module Title -->
          <h1 class="npi-roi-mod-module-title">New Patient Results</h1>

          <section class="npi-roi-mod-results-panel">
            <!-- Panel Header with Time Period Tabs -->
            <div class="npi-roi-mod-panel-header">
              <div class="npi-roi-mod-time-period-tabs">
              <button class="npi-roi-mod-tab-btn active" data-period="monthly">Monthly</button>
              <button class="npi-roi-mod-tab-btn" data-period="quarterly">Quarterly</button>
              <button class="npi-roi-mod-tab-btn" data-period="yearly">Yearly</button>
              <button class="npi-roi-mod-tab-btn" data-period="total">Total</button>
              <select class="npi-roi-mod-custom-years-select" id="customYearsSelect">
                <option value="" selected disabled>X Years</option>
                <option value="3">3 Years</option>
                <option value="5">5 Years</option>
                <option value="10">10 Years</option>
              </select>
              </div>

              <!-- Location Selector (shown only in graph view) -->
              <div class="npi-roi-mod-location-selector-header" id="locationSelectorHeader" style="display: none;">
                <i class="fas fa-map-marker-alt"></i>
                <select class="npi-roi-mod-location-select" id="locationSelect">
                  <option value="all">All locations</option>
                  <option value="bradley-place">Bradley Place</option>
                  <option value="east-lake">East Lake</option>
                  <option value="fullerton">Fullerton</option>
                  <option value="westside">Westside</option>
                  <option value="north-point">North Point</option>
                  <option value="riverside">Riverside</option>
                  <option value="downtown">Downtown</option>
                </select>
              </div>

              <div class="npi-roi-mod-panel-actions">
                <div class="npi-roi-mod-view-toggle npi-roi-mod-active-table" id="viewToggle">
                  <div class="npi-roi-mod-toggle-track">
                    <div class="npi-roi-mod-toggle-option npi-roi-mod-toggle-option-left">
                      <i class="fas fa-table"></i>
                    </div>
                    <div class="npi-roi-mod-toggle-option npi-roi-mod-toggle-option-right">
                      <i class="fas fa-chart-simple"></i>
                    </div>
                    <div class="npi-roi-mod-toggle-ball">
                      <i class="fas fa-table"></i>
                      <span>Table</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Data Table -->
            <div class="npi-roi-mod-data-table-container" id="tableView">
              <table class="npi-roi-mod-data-table">
                <thead>
                  <tr>
                    <th class="npi-roi-mod-col-location">
                      <i class="fas fa-map-marker-alt"></i> Locations
                    </th>
                    <th class="npi-roi-mod-col-start-avg">
                      <i class="fas fa-flag-checkered"></i> Start Avg.
                    </th>
                    <th class="npi-roi-mod-col-new-avg">
                      <i class="fas fa-star"></i> New Avg.
                    </th>
                    <th class="npi-roi-mod-col-growth">
                      <i class="fas fa-arrow-up"></i> Growth
                    </th>
                    <th class="npi-roi-mod-col-revenue">
                      <i class="fas fa-dollar-sign"></i> Avg. $/NP
                    </th>
                    <th class="npi-roi-mod-col-growth-total">
                      <i class="fas fa-chart-simple"></i> Growth Total
                    </th>
                  </tr>
                </thead>
                <tbody id="dataTableBody">
                  <!-- Table rows will be populated by JavaScript -->
                </tbody>
              </table>
            </div>

            <!-- Graph View -->
            <div class="npi-roi-mod-graph-view-container" id="graphView" style="display: none;">
              <!-- Graph Content Area -->
              <div class="npi-roi-mod-graph-content">
                <!-- Chart Area -->
                <div class="npi-roi-mod-chart-container">
                  <!-- Graph Header with Growth Input -->
                  <div class="npi-roi-mod-graph-header">
                    <h2 class="npi-roi-mod-graph-title">
                      What if we had
                      <span class="npi-roi-mod-growth-input-wrapper"><input type="number" id="growthInput" class="npi-roi-mod-growth-input" value="54" min="0" step="1" oninput="this.value = this.value < 0 ? 0 : this.value" /></span>
                      monthly new patients?<span class="npi-roi-mod-reset-btn-wrapper"><button class="npi-roi-mod-reset-btn" id="resetBtn"><i class="fas fa-undo"></i></button></span>
                    </h2>
                    <p class="npi-roi-mod-graph-subtitle"><span id="currentAverage">49</span> is the current average. <span id="adjustedAverage">54</span> is a <span id="percentChange">10%</span> increase.</p>
                  </div>

                  <!-- Fixed Ticker Display (Absolutely Positioned) -->
                  <div class="npi-roi-mod-ticker-display" id="tickerDisplay">
                    <div class="npi-roi-mod-ticker-display-year-header" id="tickerDisplayYear">2025</div>
                    <div class="npi-roi-mod-ticker-display-content">
                      <div class="npi-roi-mod-ticker-display-section">
                        <div class="npi-roi-mod-ticker-display-label" id="tickerDisplayAdjustedLabel">Collections at 54 new patients per month for 1 year</div>
                        <div class="npi-roi-mod-ticker-display-value npi-roi-mod-ticker-display-value-adjusted" id="tickerDisplayAdjustedValue">
                          $26,914,764
                        </div>
                      </div>
                      <div class="npi-roi-mod-ticker-display-section">
                        <div class="npi-roi-mod-ticker-display-label" id="tickerDisplayCurrentLabel">Collections at 49 new patients per month for 1 year</div>
                        <div class="npi-roi-mod-ticker-display-value npi-roi-mod-ticker-display-value-current" id="tickerDisplayCurrentValue">
                          $25,058,109
                        </div>
                      </div>
                    </div>
                  </div>

                  <canvas id="collectionsChart"></canvas>
                </div>
              </div>

              <!-- Graph Legend Footer -->
              <div class="npi-roi-mod-graph-legend-footer">
                <div class="npi-roi-mod-legend-items">
                  <div class="npi-roi-mod-legend-item">
                    <span class="legend-color npi-roi-mod-legend-color-square" style="background-color: #9e9e9e;"></span>
                    <span class="npi-roi-mod-legend-label">Current avg.</span>
                  </div>
                  <div class="npi-roi-mod-legend-item">
                    <span class="legend-color npi-roi-mod-legend-color-square" style="background-color: #4caf50;" id="legendAdjustedColor"></span>
                    <span class="npi-roi-mod-legend-label" id="legendAdjustedLabel">Adjusted avg.</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Investment and Return Cards -->
            <div class="npi-roi-mod-metrics-cards" id="metricsCards">
              <div class="npi-roi-mod-metric-card npi-roi-mod-investment-card">
                <div class="npi-roi-mod-card-value-header">
                  <span id="investmentTotal">$14,587</span>
                  <span class="npi-roi-mod-period" id="investmentPeriod">/month</span>
                  <span class="npi-roi-mod-card-title">Investment</span>
                </div>
                <div class="npi-roi-mod-card-breakdown">
                  <div class="npi-roi-mod-breakdown-chip">
                    <div class="npi-roi-mod-chip-value" id="investmentProgram">$4,789</div>
                    <div class="npi-roi-mod-chip-label">New Patient Program</div>
                  </div>
                </div>
              </div>

              <div class="npi-roi-mod-metric-card npi-roi-mod-return-card">
                <div class="npi-roi-mod-card-value-header">
                  <span id="returnTotal">$610,339</span>
                  <span class="npi-roi-mod-period" id="returnPeriod">/month</span>
                  <span class="npi-roi-mod-card-title">Return</span>
                </div>
                <div class="npi-roi-mod-card-breakdown">
                  <div class="npi-roi-mod-breakdown-chip">
                    <div class="npi-roi-mod-chip-value" id="returnGrowth">250</div>
                    <div class="npi-roi-mod-chip-label">Additional New Patients</div>
                  </div>
                </div>
              </div>
            </div>

          </section>

          <!-- Panel Footnote (shows different text based on view) -->
          <div class="npi-roi-mod-panel-footnote" id="panelFootnote">
            <p id="footnoteText">*This table shows average numbers and may not match your exact collections.</p>
          </div>
        </div>

        <!-- Right Column: Quick Links -->
        <div class="col-lg-6 col-md-12">
          <aside class="npi-roi-mod-quick-links-panel">
            <h3>Quick links section</h3>
            <!-- Quick links content will go here -->
          </aside>
        </div>
      </div>
    </div>
  </main>

  <!-- Data Selector -->
  <div class="npi-roi-mod-data-selector">
    <div class="container-fluid">
      <div class="npi-roi-mod-data-selector-label">Select Practice:</div>
      <div class="npi-roi-mod-data-selector-buttons" id="dataSelector">
        <button class="npi-roi-mod-data-selector-btn active" data-doctor="Dr. Bawa">Dr. Bawa</button>
        <button class="npi-roi-mod-data-selector-btn" data-doctor="Dr. Huggins">Dr. Huggins</button>
        <button class="npi-roi-mod-data-selector-btn" data-doctor="Dr. Rencher">Dr. Rencher</button>
        <button class="npi-roi-mod-data-selector-btn" data-doctor="Dr. Smudde">Dr. Smudde</button>
        <button class="npi-roi-mod-data-selector-btn" data-doctor="Dr. Powers">Dr. Powers</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://members.mypgi.com/min/g=new-ms-js?v=0.62"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="js/sample-data.js"></script>
  <script src="js/results-module.js"></script>
</body>
</html>
