<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>New Patient Results Module</title>
  <meta name="description" content="New Patient Results Module" />
  <meta name="author" content="The Practice - Development Team" />

  <!-- Google Fonts -->
  <link
    rel="stylesheet"
    href="//fonts.googleapis.com/css?family=Lato:300,400,700,900,300italic,400italic,700italic,900italic"
  />

  <!-- Minified CSS Bundle -->
  <link
    rel="stylesheet"
    href="https://members.mypgi.com/min/g=si-ms-css?v=0.62"
  />

  <!-- Font Awesome -->
  <link
    rel="stylesheet"
    href="https://kit.fontawesome.com/425aa9ca2c.css"
    crossorigin="anonymous"
  />

  <!-- Custom Styles -->
  <link rel="stylesheet" href="styles/styles.css" />
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="container-fluid">
      <h1>Header</h1>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container-fluid">
      <div class="row">
        <!-- Left Column: New Patient Results -->
        <div class="col-lg-6 col-md-12">
          <!-- Module Title -->
          <h1 class="module-title">New Patient Results</h1>

          <section class="results-panel">
            <!-- Panel Header with Time Period Tabs -->
            <div class="panel-header">
              <div class="time-period-tabs">
              <button class="tab-btn active" data-period="monthly">Monthly</button>
              <button class="tab-btn" data-period="quarterly">Quarterly</button>
              <button class="tab-btn" data-period="yearly">Yearly</button>
              <button class="tab-btn" data-period="total">Total</button>
              <select class="custom-years-select" id="customYearsSelect">
                <option value="3" selected>3 Years</option>
                <option value="5">5 Years</option>
                <option value="10">10 Years</option>
              </select>
              </div>

              <!-- Location Selector (shown only in graph view) -->
              <div class="location-selector-header" id="locationSelectorHeader" style="display: none;">
                <i class="fas fa-map-marker-alt"></i>
                <select class="location-select" id="locationSelect">
                  <option value="all">All locations</option>
                  <option value="bradley-place">Bradley Place</option>
                  <option value="east-lake">East Lake</option>
                  <option value="fullerton">Fullerton</option>
                  <option value="westside">Westside</option>
                  <option value="north-point">North Point</option>
                  <option value="riverside">Riverside</option>
                  <option value="downtown">Downtown</option>
                </select>
              </div>

              <div class="panel-actions">
                <div class="view-toggle active-table" id="viewToggle">
                  <div class="toggle-track">
                    <div class="toggle-option toggle-option-left">
                      <i class="fas fa-table"></i>
                    </div>
                    <div class="toggle-option toggle-option-right">
                      <i class="fas fa-chart-simple"></i>
                    </div>
                    <div class="toggle-ball">
                      <i class="fas fa-table"></i>
                      <span>Table</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Data Table -->
            <div class="data-table-container" id="tableView">
              <table class="data-table">
                <thead>
                  <tr>
                    <th class="col-location">
                      <i class="fas fa-map-marker-alt"></i> Locations
                    </th>
                    <th class="col-start-avg">
                      <i class="fas fa-flag-checkered"></i> Start Avg.
                    </th>
                    <th class="col-new-avg">
                      <i class="fas fa-star"></i> New Avg.
                    </th>
                    <th class="col-growth">
                      <i class="fas fa-arrow-up"></i> Growth
                    </th>
                    <th class="col-revenue">
                      <i class="fas fa-dollar-sign"></i> Avg. $/NP
                    </th>
                    <th class="col-growth-total">
                      <i class="fas fa-chart-simple"></i> Growth Total
                    </th>
                  </tr>
                </thead>
                <tbody id="dataTableBody">
                  <!-- Table rows will be populated by JavaScript -->
                </tbody>
              </table>
            </div>

            <!-- Graph View -->
            <div class="graph-view-container" id="graphView" style="display: none;">
              <!-- Graph Content Area -->
              <div class="graph-content">
                <!-- Chart Area -->
                <div class="chart-container">
                  <!-- Graph Header with Growth Input -->
                  <div class="graph-header">
                    <h2 class="graph-title">
                      What if we had
                      <span class="growth-input-wrapper"><input type="number" id="growthInput" class="growth-input" value="49" min="0" step="1" oninput="this.value = this.value < 0 ? 0 : this.value" /></span>
                      monthly new patients?
                      <button class="reset-btn" id="resetBtn">Reset</button>
                    </h2>
                    <p class="graph-subtitle"><span id="currentAverage">49</span> is the current average. <span id="adjustedAverage">51</span> is a <span id="percentChange">4%</span> increase.</p>
                  </div>

                  <!-- Fixed Ticker Display (Absolutely Positioned) -->
                  <div class="ticker-display" id="tickerDisplay">
                    <div class="ticker-display-year-header" id="tickerDisplayYear">2025</div>
                    <div class="ticker-display-content">
                      <div class="ticker-display-section">
                        <div class="ticker-display-label">Adjusted collections</div>
                        <div class="ticker-display-value ticker-display-value-adjusted" id="tickerDisplayAdjustedValue">
                          $26,914,764
                        </div>
                      </div>
                      <div class="ticker-display-section">
                        <div class="ticker-display-label">Current collections</div>
                        <div class="ticker-display-value ticker-display-value-current" id="tickerDisplayCurrentValue">
                          $25,058,109
                        </div>
                      </div>
                    </div>
                  </div>

                  <canvas id="collectionsChart"></canvas>
                </div>
              </div>

              <!-- Graph Legend Footer -->
              <div class="graph-legend-footer">
                <div class="legend-items">
                  <div class="legend-item">
                    <span class="legend-color legend-color-square" style="background-color: #9e9e9e;"></span>
                    <span class="legend-label">Current avg.</span>
                  </div>
                  <div class="legend-item">
                    <span class="legend-color legend-color-square" style="background-color: #4caf50;" id="legendAdjustedColor"></span>
                    <span class="legend-label" id="legendAdjustedLabel">Adjusted avg.</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Investment and Return Cards -->
            <div class="metrics-cards" id="metricsCards">
              <div class="metric-card investment-card">
                <div class="card-value-header">
                  <span id="investmentTotal">$14,587</span>
                  <span class="period" id="investmentPeriod">/month</span>
                  <span class="card-title">Investment</span>
                </div>
                <div class="card-breakdown">
                  <div class="breakdown-chip">
                    <div class="chip-value" id="investmentProgram">$4,789</div>
                    <div class="chip-label">New Patient Program</div>
                  </div>
                </div>
              </div>

              <div class="metric-card return-card">
                <div class="card-value-header">
                  <span id="returnTotal">$610,339</span>
                  <span class="period" id="returnPeriod">/month</span>
                  <span class="card-title">Return</span>
                </div>
                <div class="card-breakdown">
                  <div class="breakdown-chip">
                    <div class="chip-value" id="returnGrowth">250</div>
                    <div class="chip-label">Additional New Patients</div>
                  </div>
                </div>
              </div>
            </div>

          </section>

          <!-- Panel Footnote (shows different text based on view) -->
          <div class="panel-footnote" id="panelFootnote">
            <p id="footnoteText">*This table shows average numbers and will not match your actual collections exactly.</p>
          </div>
        </div>

        <!-- Right Column: Quick Links -->
        <div class="col-lg-6 col-md-12">
          <aside class="quick-links-panel">
            <h3>Quick links section</h3>
            <!-- Quick links content will go here -->
          </aside>
        </div>
      </div>
    </div>
  </main>

  <!-- Scripts -->
  <script src="https://members.mypgi.com/min/g=new-ms-js?v=0.62"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="js/results-module.js"></script>
</body>
</html>
